# This file is dual licensed under the terms of the Apache License, Version
# 2.0, and the BSD License. See the LICENSE file in the root of this repository
# for complete details.

<<<<<<< HEAD
from __future__ import annotations

from cryptography.hazmat.bindings._rust import asn1
from cryptography.hazmat.primitives import hashes

decode_dss_signature = asn1.decode_dss_signature
encode_dss_signature = asn1.encode_dss_signature


class Prehashed:
    def __init__(self, algorithm: hashes.HashAlgorithm):
=======
from __future__ import absolute_import, division, print_function

from cryptography import utils
from cryptography.hazmat._der import (
    DERReader,
    INTEGER,
    SEQUENCE,
    encode_der,
    encode_der_integer,
)
from cryptography.hazmat.primitives import hashes


def decode_dss_signature(signature):
    with DERReader(signature).read_single_element(SEQUENCE) as seq:
        r = seq.read_element(INTEGER).as_integer()
        s = seq.read_element(INTEGER).as_integer()
        return r, s


def encode_dss_signature(r, s):
    return encode_der(
        SEQUENCE,
        encode_der(INTEGER, encode_der_integer(r)),
        encode_der(INTEGER, encode_der_integer(s)),
    )


class Prehashed(object):
    def __init__(self, algorithm):
>>>>>>> 90f5ddd1 (Initial commit: Integrated Google Classroom API and report generation)
        if not isinstance(algorithm, hashes.HashAlgorithm):
            raise TypeError("Expected instance of HashAlgorithm.")

        self._algorithm = algorithm
        self._digest_size = algorithm.digest_size

<<<<<<< HEAD
    @property
    def digest_size(self) -> int:
        return self._digest_size
=======
    digest_size = utils.read_only_property("_digest_size")
>>>>>>> 90f5ddd1 (Initial commit: Integrated Google Classroom API and report generation)
